{"ast":null,"code":"import translateToPoint from './translate-to-point';\nimport stackElements from './stack-elements';\n\nfunction getStacks(elements, rect, sizeField) {\n  var maxSize = rect.size[sizeField];\n  var stacks = [];\n  var stack = [];\n  var stackSize = 0;\n  var element, bbox;\n\n  var addElementToStack = function () {\n    stack.push({\n      element: element,\n      bbox: bbox\n    });\n  };\n\n  for (var idx = 0; idx < elements.length; idx++) {\n    element = elements[idx];\n    bbox = element.clippedBBox();\n\n    if (bbox) {\n      var size = bbox.size[sizeField];\n\n      if (stackSize + size > maxSize) {\n        if (stack.length) {\n          stacks.push(stack);\n          stack = [];\n          addElementToStack();\n          stackSize = size;\n        } else {\n          addElementToStack();\n          stacks.push(stack);\n          stack = [];\n          stackSize = 0;\n        }\n      } else {\n        addElementToStack();\n        stackSize += size;\n      }\n    }\n  }\n\n  if (stack.length) {\n    stacks.push(stack);\n  }\n\n  return stacks;\n}\n\nexport default function wrapElements(elements, rect, axis, otherAxis, sizeField) {\n  var stacks = getStacks(elements, rect, sizeField);\n  var origin = rect.origin.clone();\n  var result = [];\n\n  for (var idx = 0; idx < stacks.length; idx++) {\n    var stack = stacks[idx];\n    var startElement = stack[0];\n    origin[otherAxis] = startElement.bbox.origin[otherAxis];\n    translateToPoint(origin, startElement.bbox, startElement.element);\n    startElement.bbox.origin[axis] = origin[axis];\n    stackElements(stack, axis, otherAxis, sizeField);\n    result.push([]);\n\n    for (var elementIdx = 0; elementIdx < stack.length; elementIdx++) {\n      result[idx].push(stack[elementIdx].element);\n    }\n  }\n\n  return result;\n}","map":null,"metadata":{},"sourceType":"module"}